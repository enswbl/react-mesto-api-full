(this["webpackJsonpreact-mesto-auth"]=this["webpackJsonpreact-mesto-auth"]||[]).push([[0],{29:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),i=n(19),s=n.n(i),c=n(7),r=(n(29),n(24)),u=n(2),l=n(3),p=n.p+"static/media/white-logo.ff16f24b.svg",m=n(0),d=function(e){var t=e.userData;console.log("userData",t);var n=Object(l.g)(),a=Object(l.h)().pathname;return Object(m.jsxs)("header",{className:"header",children:[Object(m.jsx)("a",{href:"/users/me",children:Object(m.jsx)("img",{src:p,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f",className:"header__logo"})}),Object(m.jsxs)("div",{className:"header__container",children:["/users/me"===a&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("p",{className:"header__email",children:t.email}),Object(m.jsx)(c.b,{className:"header__button header__button_sign-in",onClick:function(){localStorage.removeItem("token"),n.push("/sign-up")},children:"\u0412\u044b\u0439\u0442\u0438"})]}),"/sign-up"===a&&Object(m.jsx)(c.b,{className:"header__button",to:"/sign-in",children:"\u0412\u043e\u0439\u0442\u0438"}),"/sign-in"===a&&Object(m.jsx)(c.b,{className:"header__button",to:"/sign-up",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})]})]})},h=o.a.createContext();var j=function(e){var t=e.title,n=e.image,a=e.like,i=e.owner,s=e.id,c=e.onSelectedCard,r=e.onLikeCard,u=e.onRemoveCard,l=o.a.useContext(h),p=l._id===i,d=a.some((function(e){return e._id===l._id}));return Object(m.jsxs)("div",{className:"card",children:[Object(m.jsx)("button",{type:"submit",className:"card__remove-button ".concat(p?"card__remove-button_active":""),onClick:function(){u(s)}}),Object(m.jsx)("img",{className:"card__image",src:n,alt:t,onClick:function(){c({title:t,image:n})}}),Object(m.jsxs)("div",{className:"card__panel",children:[Object(m.jsx)("h2",{className:"card__title",children:t}),Object(m.jsxs)("div",{className:"card__like-container",children:[Object(m.jsx)("button",{type:"submit",className:"card__like-button ".concat(d?"card__like-button_active":""),onClick:function(){r({like:a,id:s})}}),Object(m.jsx)("label",{className:"card__like-number",children:a.length})]})]})]})};var b=function(e){var t=e.onEditAvatar,n=e.onEditProfile,a=e.onAddPlace,i=e.currentCards,s=e.onSelectedCard,c=e.onLikeCard,r=e.onRemoveCard,u=o.a.useContext(h);return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("section",{className:"profile",children:[Object(m.jsx)("img",{src:u.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:"profile__avatar"}),Object(m.jsx)("button",{className:"profile__edit-avatar-button",onClick:t}),Object(m.jsxs)("div",{className:"profile__info",children:[Object(m.jsxs)("div",{className:"profile__name-container",children:[Object(m.jsx)("h1",{className:"profile__name",children:u.name}),Object(m.jsx)("button",{type:"button",className:"profile__edit-profile-button",onClick:n})]}),Object(m.jsx)("p",{className:"profile__description",children:u.about})]}),Object(m.jsx)("button",{type:"button",className:"profile__add-place-button",onClick:a})]}),Object(m.jsx)("section",{className:"container",children:i.map((function(e){return Object(m.jsx)(j,{title:e.name,image:e.link,like:e.likes,owner:e.owner._id,id:e._id,onSelectedCard:s,onLikeCard:c,onRemoveCard:r},e._id)}))})]})};var f=function(e){var t=e.title,n=e.name,a=e.onSubmit,o=e.isOpen,i=e.onClose,s=e.buttonText,c=e.children;return Object(m.jsxs)("div",{className:"popup popup-".concat(n," ").concat(o?"popup_opened":""),children:[Object(m.jsx)("button",{type:"reset",className:"popup__close-button",onClick:i}),Object(m.jsxs)("form",{action:"#",method:"GET",name:n,className:"popup__container",onSubmit:a,noValidate:!0,children:[Object(m.jsx)("h3",{className:"popup__title",children:t}),c,Object(m.jsx)("button",{type:"submit",className:"popup__save-button",children:s})]})]})};var _=function(e){var t=e.onUpdateAvatar,n=e.isOpen,a=e.onClose,i=o.a.useRef();return Object(m.jsxs)(f,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"edit-avatar",onSubmit:function(e){e.preventDefault(),t({avatar:i.current.value}),i.current.value=""},isOpen:n,onClose:a,buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",children:[Object(m.jsx)("input",{ref:i,type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatarLinkInput",id:"avatar-link-input",className:"popup__input popup__input_add-place popup__input_avatar-link",autoComplete:"off",required:!0}),Object(m.jsx)("span",{className:"popup__input-error-message avatar-link-input-error-message"})]})};var O=function(e){var t=e.onUpdateUser,n=e.isOpen,a=e.onClose,i=o.a.useContext(h),s=o.a.useState(""),c=Object(u.a)(s,2),r=c[0],l=c[1],p=o.a.useState(""),d=Object(u.a)(p,2),j=d[0],b=d[1];return o.a.useEffect((function(){l(i.name),b(i.about)}),[i]),Object(m.jsxs)(f,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit-profile",onSubmit:function(e){e.preventDefault(),t({name:r,description:j})},isOpen:n,onClose:a,buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",children:[Object(m.jsx)("input",{value:r,onChange:function(e){l(e.target.value)},type:"text",name:"profileNameInput",id:"profile-name-input",className:"popup__input popup__input_profile-name",minLength:"2",maxLength:"40",autoComplete:"off",required:!0}),Object(m.jsx)("span",{className:"popup__input-error-message profile-name-input-error-message"}),Object(m.jsx)("input",{value:j,onChange:function(e){b(e.target.value)},type:"text",name:"profileDescriptionInput",id:"profile-description-input",className:"popup__input popup__input_profile-description",minLength:"2",maxLength:"200",autoComplete:"off",required:!0}),Object(m.jsx)("span",{className:"popup__input-error-message profile-description-input-error-message"})]})};var g=function(e){var t=e.onAddPlace,n=e.isOpen,a=e.onClose,i=o.a.useState(""),s=Object(u.a)(i,2),c=s[0],r=s[1],l=o.a.useState(""),p=Object(u.a)(l,2),d=p[0],h=p[1];return Object(m.jsxs)(f,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add-place",onSubmit:function(e){e.preventDefault(),t({title:c,image:d})},isOpen:n,onClose:a,buttonText:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",children:[Object(m.jsx)("input",{onChange:function(e){r(e.target.value)},type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",name:"placeNameInput",id:"place-name-input",className:"popup__input popup__input_add-place popup__input_place-name",minLength:"2",maxLength:"30",autoComplete:"off",required:!0}),Object(m.jsx)("span",{className:"popup__input-error-message place-name-input-error-message"}),Object(m.jsx)("input",{onChange:function(e){h(e.target.value)},type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",name:"placeLinkInput",id:"place-link-input",className:"popup__input popup__input_add-place popup__input_place-link",autoComplete:"off",required:!0}),Object(m.jsx)("span",{className:"popup__input-error-message place-link-input-error-message"})]})};var v=function(e){var t=e.selectedImage,n=e.isOpen,a=e.onClose;return Object(m.jsx)("div",{className:"popup popup-photo ".concat(n?"popup_opened":""),children:Object(m.jsxs)("div",{className:"popup__photo-container",children:[Object(m.jsx)("button",{type:"reset",className:"popup__close-button popup__close-button_photo",onClick:a}),Object(m.jsx)("img",{className:"popup__image",src:n?t.image:"",alt:n?t.title:""}),Object(m.jsx)("p",{className:"popup__photo-title",children:n?t.title:""})]})})};var x=function(e){var t=e.removeIdCard,n=e.onDeleteCard,a=e.isOpen,o=e.onClose;return Object(m.jsx)(f,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"remove-card",onSubmit:function(e){e.preventDefault(),n(t)},isOpen:a,onClose:o,buttonText:"\u0414\u0430"})};var C=function(){return Object(m.jsx)("footer",{className:"footer",children:Object(m.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})},N=n(21),k=n(22),S=new(function(){function e(t){var n=t.baseUrl,a=t.authorization;Object(N.a)(this,e),this._baseUrl=n,this._authorization=a}return Object(k.a)(e,[{key:"_checkErrors",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:{authorization:this._authorization}}).then((function(t){return e._checkErrors(t)}))}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:{authorization:this._authorization}}).then((function(t){return e._checkErrors(t)}))}},{key:"setUserInfo",value:function(e){var t=this,n=e.name,a=e.description;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({name:n,about:a})}).then((function(e){return t._checkErrors(e)}))}},{key:"setUserAvatar",value:function(e){var t=this,n=e.avatar;return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({avatar:n})}).then((function(e){return t._checkErrors(e)}))}},{key:"sendCard",value:function(e){var t=this,n=e.title,a=e.image;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({name:n,link:a})}).then((function(e){return t._checkErrors(e)}))}},{key:"setLike",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:{authorization:this._authorization}}).then((function(e){return t._checkErrors(e)}))}},{key:"removeLike",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:{authorization:this._authorization}}).then((function(e){return t._checkErrors(e)}))}},{key:"removeCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:{authorization:this._authorization}}).then((function(e){return t._checkErrors(e)}))}}]),e}())({baseUrl:"https://mestoapp.nomoredomains.club"}),y=n.p+"static/media/avatar.c15cb08a.jpg",E=n(11),L=n(10),T=Object(l.i)((function(e){var t=e.handleLogin,n=o.a.useState({email:"",password:""}),a=Object(u.a)(n,2),i=a[0],s=a[1],c=function(e){var t=e.target,n=t.name,a=t.value;s(Object(L.a)(Object(L.a)({},i),{},Object(E.a)({},n,a)))};return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("form",{action:"#",method:"GET",onSubmit:function(e){e.preventDefault(),t(i)},className:"login",children:[Object(m.jsx)("h1",{className:"login__title",children:"\u0412\u0445\u043e\u0434"}),Object(m.jsx)("input",{onChange:c,value:i.email,id:"email",name:"email",className:"login__input",type:"email",placeholder:"Email",minLength:"2",maxLength:"30",autoComplete:"off",required:!0}),Object(m.jsx)("input",{onChange:c,value:i.password,id:"password",name:"password",className:"login__input",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",minLength:"2",maxLength:"30",autoComplete:"off",required:!0}),Object(m.jsx)("button",{type:"submit",className:"login__button login__button_sign-in ",children:"\u0412\u043e\u0439\u0442\u0438"})]})})})),w=Object(l.i)((function(e){var t=e.handleRegister,n=o.a.useState({email:"",password:""}),a=Object(u.a)(n,2),i=a[0],s=a[1],r=function(e){var t=e.target,n=t.name,a=t.value;s(Object(L.a)(Object(L.a)({},i),{},Object(E.a)({},n,a)))};return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("form",{action:"#",method:"GET",onSubmit:function(e){e.preventDefault(),t(i)},className:"login",children:[Object(m.jsx)("h1",{className:"login__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(m.jsx)("input",{onChange:r,value:i.email,id:"email",name:"email",className:"login__input",type:"email",placeholder:"Email",minLength:"2",maxLength:"30",autoComplete:"off",required:!0}),Object(m.jsx)("input",{onChange:r,value:i.password,id:"password",name:"password",className:"login__input",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",minLength:"2",maxLength:"30",autoComplete:"off",required:!0}),Object(m.jsx)("button",{type:"submit",className:"login__button",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),Object(m.jsx)(c.b,{to:"/sign-in",className:"login__link",children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438"})]})})})),I=n(23),U=function(e){var t=e.component,n=Object(I.a)(e,["component"]);return Object(m.jsx)(l.b,{children:function(){return n.loggedIn?Object(m.jsxs)(m.Fragment,{children:[" ",Object(m.jsx)(l.a,{to:"/users/me"})," ",Object(m.jsx)(t,Object(L.a)({},n))," ",Object(m.jsx)(C,{})," "]}):Object(m.jsx)(l.a,{to:"/sign-up"})}})},z=n.p+"static/media/success.1b6082f8.svg",P=n.p+"static/media/fail.df8eddf6.svg";var A=function(e){var t=e.status,n=e.isOpen,a=e.setShowStatus,o=Object(l.g)();return Object(m.jsxs)("div",{className:"popup popup-status ".concat(n?"popup_opened":""),children:[t?Object(m.jsx)("button",{type:"reset",className:"popup__close-button popup__close-button_status",onClick:function(){a({isOpen:!1}),setTimeout((function(){o.push("/sign-in")}),300)}}):Object(m.jsx)("button",{type:"reset",className:"popup__close-button popup__close-button_status",onClick:function(){a({isOpen:!1})}}),Object(m.jsxs)("div",{className:"popup__container",children:[Object(m.jsx)("img",{src:t?z:P,alt:t?"success":"fail",className:"popup__icon"}),Object(m.jsx)("h3",{className:"popup__status-name",children:t?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a!\n\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."})]})]})},D="https://mestoapp.nomoredomains.club",F=function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))};var q=function(){var e=o.a.useState({isOpen:!1}),t=Object(u.a)(e,2),n=t[0],a=t[1],i=o.a.useState({isOpen:!1}),s=Object(u.a)(i,2),c=s[0],p=s[1],j=o.a.useState({isOpen:!1}),f=Object(u.a)(j,2),C=f[0],N=f[1],k=o.a.useState({isOpen:!1}),E=Object(u.a)(k,2),L=E[0],I=E[1],z=o.a.useState({title:"",image:""}),P=Object(u.a)(z,2),q=P[0],R=P[1],W=o.a.useState({isOpen:!1}),J=Object(u.a)(W,2),G=J[0],B=J[1],H=o.a.useState(),M=Object(u.a)(H,2),V=M[0],K=M[1],Q=o.a.useState({avatar:y,name:"\u0416\u0430\u043a-\u0418\u0432 \u041a\u0443\u0441\u0442\u043e",about:"\u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043e\u043a\u0435\u0430\u043d\u0430",_id:""}),X=Object(u.a)(Q,2),Y=X[0],Z=X[1],$=o.a.useState([]),ee=Object(u.a)($,2),te=ee[0],ne=ee[1],ae=o.a.useState(),oe=Object(u.a)(ae,2),ie=oe[0],se=oe[1],ce=o.a.useState({email:""}),re=Object(u.a)(ce,2),ue=re[0],le=re[1],pe=o.a.useState(),me=Object(u.a)(pe,2),de=me[0],he=me[1],je=o.a.useState({isOpen:!1}),be=Object(u.a)(je,2),fe=be[0],_e=be[1],Oe=Object(l.g)();o.a.useEffect((function(){S.getUserInfo().then((function(e){Z(e)})).catch((function(e){console.log("Something is Wrong:",e)}))}),[]),o.a.useEffect((function(){S.getInitialCards().then((function(e){ne(e)})).catch((function(e){console.log("Something is Wrong:",e)}))}),[]),o.a.useEffect((function(){ie&&Oe.push("/users/me")}),[ie]),o.a.useEffect((function(){ve()}),[]);var ge=function(){a({isOpen:!1}),p({isOpen:!1}),N({isOpen:!1}),B({isOpen:!1}),I({isOpen:!1})},ve=function(){localStorage.getItem("token")&&function(e){return fetch("".concat(D,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return F(e)})).then((function(e){return e}))}(localStorage.getItem("token")).then((function(e){e&&(se(!0),Oe.push("/users/me"),le({email:e.data.email}))}))};return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(h.Provider,{value:Y,children:[Object(m.jsx)(d,{userData:ue}),Object(m.jsxs)("main",{className:"content",children:[Object(m.jsx)(l.b,{path:"/",children:ie&&Object(m.jsx)(l.a,{to:"/users/me"})}),Object(m.jsxs)(l.d,{children:[Object(m.jsx)(l.b,{path:"/sign-up",children:Object(m.jsx)(w,{handleRegister:function(e){return function(e){var t=e.email,n=e.password;return fetch("".concat(D,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:n,email:t})}).then((function(e){return F(e)})).then((function(e){return e}))}({email:e.email,password:e.password}).then((function(e){if(e.data)return localStorage.setItem("token",e.token),he(!0),_e({isOpen:!0}),e})).catch((function(){he(!1),_e({isOpen:!0})}))}})}),Object(m.jsx)(l.b,{path:"/sign-in",children:Object(m.jsx)(T,{handleLogin:function(e){return function(e){var t=e.email,n=e.password;return fetch("".concat(D,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:n,email:t})}).then((function(e){return F(e)})).then((function(e){return e}))}({email:e.email,password:e.password}).then((function(e){if(e.token)return se(!0),localStorage.setItem("token",e.token),ve(),setTimeout((function(){Oe.push("/users/me")}),2e3),e})).catch((function(){console.log("Error!")}))}})}),Object(m.jsx)(U,{exact:!0,path:"*",loggedIn:ie,onEditAvatar:function(){a({isOpen:!0})},onEditProfile:function(){p({isOpen:!0})},onAddPlace:function(){N({isOpen:!0})},currentCards:te,onSelectedCard:function(e){I({isOpen:!0}),R({title:e.title,image:e.image})},onLikeCard:function(e){var t=e.like,n=e.id,a=t.some((function(e){return e._id===Y._id}));a?S.removeLike(n,a).then((function(e){ne((function(t){return t.map((function(t){return t._id===n?e:t}))}))})).catch((function(e){console.log("Something is Wrong:",e)})):S.setLike(n,!a).then((function(e){ne((function(t){return t.map((function(t){return t._id===n?e:t}))}))})).catch((function(e){console.log("Something is Wrong:",e)}))},onRemoveCard:function(e){B({isOpen:!0}),K(e)},component:b})]}),Object(m.jsxs)("section",{className:"popups",children:[Object(m.jsx)(_,{onUpdateAvatar:function(e){var t=e.avatar;S.setUserAvatar({avatar:t}).then((function(e){Z(e),ge()})).catch((function(e){console.log("Something is Wrong:",e)}))},isOpen:n.isOpen,onClose:ge}),Object(m.jsx)(O,{onUpdateUser:function(e){var t=e.name,n=e.description;S.setUserInfo({name:t,description:n}).then((function(e){Z(e),ge()})).catch((function(e){console.log("Something is Wrong:",e)}))},isOpen:c.isOpen,onClose:ge}),Object(m.jsx)(g,{onAddPlace:function(e){var t=e.title,n=e.image;S.sendCard({title:t,image:n}).then((function(e){ne([e].concat(Object(r.a)(te))),ge()})).catch((function(e){console.log("Something is Wrong:",e)}))},isOpen:C.isOpen,onClose:ge}),Object(m.jsx)(x,{removeIdCard:V,onDeleteCard:function(e){S.removeCard(e).then((function(){ne(te.filter((function(t){return t._id!==e}))),ge()})).catch((function(e){console.log("Something is Wrong:",e)}))},isOpen:G.isOpen,onClose:ge}),Object(m.jsx)(v,{selectedImage:q,isOpen:L.isOpen,onClose:ge}),Object(m.jsx)(A,{status:de,isOpen:fe.isOpen,setShowStatus:_e})]})]})]})})},R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,40)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),a(e),o(e),i(e),s(e)}))};s.a.render(Object(m.jsx)(o.a.StrictMode,{children:Object(m.jsx)(c.a,{children:Object(m.jsx)(q,{})})}),document.getElementById("root")),R()}},[[39,1,2]]]);
//# sourceMappingURL=main.be091bf2.chunk.js.map